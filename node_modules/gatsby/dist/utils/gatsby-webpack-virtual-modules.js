"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports.writeModule = writeModule;
exports.GatsbyWebpackVirtualModules = void 0;

var _webpackVirtualModules = _interopRequireDefault(require("webpack-virtual-modules"));

const fileContentLookup = {};
const instances = [];

class GatsbyWebpackVirtualModules {
  apply(compiler) {
    const virtualModules = new _webpackVirtualModules.default(fileContentLookup);
    virtualModules.apply(compiler);
    instances.push({
      writeModule: virtualModules.writeModule.bind(virtualModules)
    });
  }

}

exports.GatsbyWebpackVirtualModules = GatsbyWebpackVirtualModules;

function writeModule(filePath, fileContents) {
  // "node_modules" added in front of filePath allow to allow importing
  // those modules using same path
  const adjustedFilePath = `node_modules/${filePath}`;

  if (fileContentLookup[adjustedFilePath] === fileContents) {
    // we already have this, no need to cause invalidation
    return;
  }

  fileContentLookup[adjustedFilePath] = fileContents;
  instances.forEach(instance => {
    instance.writeModule(adjustedFilePath, fileContents);
  });
}
//# sourceMappingURL=gatsby-webpack-virtual-modules.js.map